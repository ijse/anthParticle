!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.anthParticle=t()}}(function(){var t;return function e(t,i,a){function n(s,o){if(!i[s]){if(!t[s]){var c="function"==typeof require&&require;if(!o&&c)return c(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var h=i[s]={exports:{}};t[s][0].call(h.exports,function(e){var i=t[s][1][e];return n(i?i:e)},h,h.exports,e,t,i,a)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<a.length;s++)n(a[s]);return n}({1:[function(t,e){"use strict";function i(t){this.image=t.image,this.imageScale=t.imageScale,this.models=t.models,this.sceneWidth=t.sceneWidth,this.sceneHeight=t.sceneHeight,this.chanceBox=this.models.map(function(t){var e=t.chance_range.values;return[e,t]})}{var a=t("./util.js"),n=t("./model.js");t("./vector.js")}i.prototype.randomModel=function(){var t=a.getRandomArbitry(0,1),e=this.chanceBox.filter(function(e){return t>=e[0][0]&&t<e[0][1]},this);if(!e)throw"Model chance range must be added up to 1.";return e[0][1]},i.prototype.fire=function(){var t=this,e=this.randomModel(),i=new n(e,function(e){return a.clipImageToCanvas.bind(null,t.image).apply(null,e)});return i.initPosition(this.sceneWidth,this.sceneHeight),i},e.exports=i},{"./model.js":3,"./util.js":5,"./vector.js":6}],2:[function(t,e){"use strict";function i(t,e){if(!t.canvas)throw"AnthParticle need canvas and loader options.";this.frameId=0,t=t||{},this.fps=t.fps||60,this.fpsMeter=t.fpsMeter,this.animationFrame=new n(this.fps),this._id=t.id||"id_"+ +new Date,this._canvas=t.canvas,this.loader=t.loader,this.curScene=null,this.emitter=null,this.status={error:!1,loaded:!1,roundKey:Date.now(),animating:!1},this.loader&&this.reload(this.loader,e),i._stats.create++,a("Create new anthParticle instance",this)}var a=t("debug")("ap:index"),n=t("animation-frame"),r=(t("./model.js"),t("./emitter.js"),t("./scene.js"));n.FRAME_RATE=30,e.exports=i,i.VERSION=t("../package.json").version,i._stats={create:0},i.prototype.reload=function(t,e){var i=this;t&&(this.loader=t),this.loader.load(function(t,a,n){t||(i.curScene=new r({canvas:i._canvas,image:n,data:a.scene}),i.status.loaded=!0,i.stop()),e&&e.call(i,t)})},i.prototype.start=function(t){var e=this;if(!this.status.loaded)throw"anthParticle have not loaded.";if(!this.status.animating){t||(this.status.roundKey=Date.now()),a("start play animation frames");var i=e.animationFrame,n=e.tick,r=e.status,s=1e3/e.fps;e.status.animating=!0,e.frameId=function o(t){if(t===e.status.roundKey){var a=Date.now();return i.request(function(){if(e.fpsMeter&&e.fpsMeter.tickStart(),r.animating){var i=Date.now()-a;Math.abs(i-s)<=.1*s&&n.call(e,i,e.fps),e.fpsMeter&&e.fpsMeter.tick(),o(t)}})}}.call(e,e.status.roundKey)}},i.prototype.pause=function(){this.status.animating=!1},i.prototype.play=function(){this.start(!0)},i.prototype.stop=function(){a("stop play animation frames"),this.animationFrame.cancel(this.frameId),this.status.animating=!1},i.prototype.tick=function(t,e){this.curScene.render(t,e)}},{"../package.json":11,"./emitter.js":1,"./model.js":3,"./scene.js":4,"animation-frame":7,debug:8}],3:[function(t,e){"use strict";function i(t,e){this.data=t,this.life=n.getRandom.apply(null,t.active_time.values),this.age=0,this.position=r.zero,this.oriPosition=r.zero,this.destPosition=r.zero,this.velocity=r.zero,this.acceleration=r.zero,this.image=e(t.src_ltwh.values);var i=3*this.image.width,a=3*this.image.height;this.imageCanvas=n.createCanvas(i,a);var s=t.alpha.values,o=t.scale.values;this.finalAlpha=n.getRandom.apply(null,s)/255,this.fromScale=n.getRandomArbitry.apply(null,o),this.toScale=n.getRandomArbitry.apply(null,o.slice(2)),this.alpha=0,this.scale=0,this.momentIn=+s[2],this.momentOut=+s[3]}var a=t("debug")("ap:model"),n=t("./util.js"),r=t("./vector.js");i.prototype.initPosition=function(t,e){function i(i){var a=r.zero,s=null,o=+i[0],c=+i[1],h="match_parent"===(s=i[2])?t:o+ +s,l="match_parent"===(s=i[3])?e:c+ +s,u=n.getRandom(o,h),f=n.getRandom(c,l);return a=new r(u,f)}var s=this.data.move_from_rect.values,o=this.data.move_to_rect.values,c=new r(this.imageCanvas.width,this.imageCanvas.height),h=i(s).subtract(c);a("model original position",h);var l=i(o).add(c);a("model destinate position",l);var u=l.subtract(h),f=u.divide(this.life);this.oriPosition=h,this.position=h.copy(),this.destPosition=l,this.velocity=f,this.initRotation()},i.prototype.initRotation=function(){var t=this.data.rotate.values,e=+t[4],i=+t[5];this.rotateOn=new r(e,i),this.rotateFrom=n.getRandom(t[0],t[1]),this.rotateTo=n.getRandom(t[2],t[3]),this.rotateStep=(this.rotateTo-this.rotateFrom)/this.life,this.rotateAngle=this.rotateFrom},i.prototype.draw=function(t){var e=this.imageCanvas.width,i=this.imageCanvas.height,n=this.imageCanvas.getContext("2d"),r=e/4+this.rotateOn.x,s=i/4+this.rotateOn.y;n.save(),n.clearRect(0,0,e,i),n.globalAlpha=this.alpha,n.fillStyle="transparent",n.scale(this.scale,this.scale),n.translate(r,s),n.rotate(this.rotateAngle*Math.PI/180),n.drawImage(this.image,0,0),n.restore(),a("My alpha is: ",this.alpha),a("My scale is: ",this.scale),t.drawImage(this.imageCanvas,this.position.x,this.position.y)},i.prototype.update=function(){return this.move(),this.setRotate(),this.setAlpha(),this.setScale(),this},i.prototype.move=function(){var t=this.velocity.multiply(this.age);a("move distance: ",t),this.position=this.oriPosition.add(t)},i.prototype.setRotate=function(){this.rotateAngle=this.rotateStep*this.age,a("Rotate angule: ",this.rotateAngle)},i.prototype.setAlpha=function(){var t,e;this.age/this.life<this.momentIn?(t=this.finalAlpha/(this.life*this.momentIn),this.alpha=t*this.age):this.age/this.life>this.momentOut?(e=this.finalAlpha/(this.life*this.momentOut),this.alpha=e*(this.life-this.age)):this.alpha=this.finalAlpha},i.prototype.setScale=function(){var t,e,i;this.age/this.life<this.momentIn?(t=this.fromScale/(this.life*this.momentIn),this.scale=t*this.age):this.age/this.life>this.momentOut?(i=this.toScale/(this.life*this.momentOut),this.scale=i*(this.life-this.age)):(e=(this.toScale-this.fromScale)/this.life,this.scale=this.fromScale+e*(this.age-this.life*this.momentIn))},i.prototype.setAge=function(t){this.age=t,this.update()},i.prototype.grow=function(t){this.age+=parseInt(t),this.update()},i.prototype.isDead=function(){return this.life<=this.age},e.exports=i},{"./util.js":5,"./vector.js":6,debug:8}],4:[function(t,e){"use strict";function i(t){this.width=parseInt(t.data.width_height.values[0]),this.height=parseInt(t.data.width_height.values[1]),this.canvas=t.canvas,this.canvas.width=this.width,this.canvas.height=this.height,this.maxModels=t.data.max.values[0],this.gravity=t.gravity||0,this.actorList=[],this.initialInterval=300,this.initialAgep=10,this.status={atStart:!0,totalever:0};var e=t.image.width,i=t.image.height,c=o.createCanvas(e,i),h=c.getContext("2d");h.drawImage(t.image,0,0),this.emitter=new s({sceneWidth:this.width,sceneHeight:this.height,image:c,imageScale:t.data.src_scale.values,models:t.data.model}),this.initialInterval=a(this.maxModels,t.data.model),this._hireActorThrottled=o.throttle(n,this.initialInterval||300),r("initial throttle interval: ",this.initialInterval)}function a(t,e){for(var i=0,a=0,n=0;n<e.length;n++){var r=e[n],s=r.chance_range.values[1]-r.chance_range.values[0],o=+r.active_time.values[1]+~~r.active_time.values[0];a+=s*o/2}return i=a/t}function n(t,e){var i=t.emitter.fire(),a=i.life*(e%100)/100;return i.setAge(a),t.actorList.push(i),i}{var r=t("debug")("ap:scene"),s=t("./emitter.js"),o=t("./util.js");t("./vector.js")}i.prototype.render=function(t){var e,i=this.canvas,a=this.canvas.getContext("2d"),n=(Date.now(),0),s=[];for(this.actorList.length<this.maxModels?this.status.atStart?(n=o.getRandom(0,this.initialAgep),this.hireActor(n,!0),r("hire actor with throttled")):(r("hire actor without throttled"),this.hireActor()):this.status.atStart=!1,a.clearRect(0,0,i.width,i.height),e=0;e<this.actorList.length;e++){var c=this.actorList[e];c.draw(a),c.grow(t),c.isDead()&&s.push(e)}this.fireActors(s)},i.prototype.hireActor=function(t,e){var i=this._hireActorThrottled,a=null;return t=t||0,a=e?i(this,t):n(this,t)},i.prototype.fireActors=function(t){for(;t.length;){var e=t[t.length-1];this.actorList[e]=this.actorList[this.actorList.length-1],this.actorList.length--,t.length--,r("actor die",e)}},e.exports=i},{"./emitter.js":1,"./util.js":5,"./vector.js":6,debug:8}],5:[function(t,e){"use strict";var i=e.exports={};i.extend=function(t,e){function i(){}return i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.baseConstructor=e,t.superClass=e.prototype,t},i.merge=function(t){t=t||{};for(var e=1;e<arguments.length;e++)if(arguments[e])for(var i in arguments[e])arguments[e].hasOwnProperty(i)&&(t[i]=arguments[e][i]);return t},i.deepMerge=function(t){t=t||{};for(var e=1;e<arguments.length;e++){var a=arguments[e];if(a)for(var n in a)a.hasOwnProperty(n)&&("object"==typeof a[n]?i.deepMerge(t[n]||(t[n]={}),a[n]):t[n]=a[n])}return t},i.isArray=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)},i.type=function(t){return Object.prototype.toString.call(t).replace(/^\[object (.+)\]$/,"$1").toLowerCase()},i.getRandom=function(t,e){return t=parseInt(t),e=parseInt(e),Math.floor(Math.random()*(e-t))+t},i.getRandomArbitry=function(t,e){return t=parseFloat(t),e=parseFloat(e),Math.random()*(e-t)+t},i.createCanvas=function(t,e){var i=document.createElement("canvas");return i.width=t,i.height=e,i},i.clipImageToCanvas=function(t,e,a,n,r){var s=i.createCanvas(n,r),o=s.getContext("2d");return o.drawImage(t,e,a,n,r,0,0,n,r),s},i.throttle=function(t,e,i){var a,n,r,s=null,o=0;i||(i={});var c=function(){o=i.leading===!1?0:Date.now(),s=null,r=t.apply(a,n),s||(a=n=null)};return function(){var h=Date.now();o||i.leading!==!1||(o=h);var l=e-(h-o);return a=this,n=arguments,0>=l||l>e?(clearTimeout(s),s=null,o=h,r=t.apply(a,n),s||(a=n=null)):s||i.trailing===!1||(s=setTimeout(c,l)),r}}},{}],6:[function(t,e){"use strict";function i(t,e){this.x=parseFloat(t),this.y=parseFloat(e)}i.prototype={copy:function(){return new i(this.x,this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},sqrLength:function(){return this.x*this.x+this.y*this.y},normalize:function(){var t=1/this.length();return new i(this.x*t,this.y*t)},negate:function(){return new i(-this.x,-this.y)},add:function(t){return new i(this.x+t.x,this.y+t.y)},subtract:function(t){return new i(this.x-t.x,this.y-t.y)},multiply:function(t){return new i(this.x*t,this.y*t)},divide:function(t){var e=1/t;return new i(this.x*e,this.y*e)},dot:function(t){return this.x*t.x+this.y*t.y}},i.zero=new i(0,0),e.exports=i},{}],7:[function(e,i,a){!function(e){"use strict";function n(t){return this instanceof n?(t||(t={}),"number"==typeof t&&(t={frameRate:t}),null!=t.useNative||(t.useNative=!0),this.options=t,this.frameRate=t.frameRate||n.FRAME_RATE,this._frameLength=1e3/this.frameRate,this._isCustomFrameRate=this.frameRate!==n.FRAME_RATE,this._timeoutId=null,this._callbacks={},this._lastTickTime=0,void(this._tickCounter=0)):new n(t)}var r,s;!function(){var t,i,a=["webkit","moz","ms","o"];try{e.top.name,i=e.top}catch(o){i=e}for(r=i.requestAnimationFrame,s=i.cancelAnimationFrame||i.cancelRequestAnimationFrame,t=0;t<a.length&&!r;t++)r=i[a[t]+"RequestAnimationFrame"],s=i[a[t]+"CancelAnimationFrame"]||i[a[t]+"CancelRequestAnimationFrame"];r&&r(function(){n.hasNative=!0})}(),n.FRAME_RATE=60,n.shim=function(t){var i=new n(t);return e.requestAnimationFrame=function(t){return i.request(t)},e.cancelAnimationFrame=function(t){return i.cancel(t)},i},n.now=Date.now||function(){return(new Date).getTime()},n.navigationStart=n.now(),n.perfNow=function(){return e.performance&&e.performance.now?e.performance.now():n.now()-n.navigationStart},n.hasNative=!1,n.prototype.request=function(t){var i,a=this;if(++this._tickCounter,n.hasNative&&a.options.useNative&&!this._isCustomFrameRate)return r(t);if(!t)throw new TypeError("Not enough arguments");return null==this._timeoutId&&(i=this._frameLength+this._lastTickTime-n.now(),0>i&&(i=0),this._timeoutId=e.setTimeout(function(){var t;a._lastTickTime=n.now(),a._timeoutId=null,++a._tickCounter;for(t in a._callbacks)a._callbacks[t]&&(n.hasNative&&a.options.useNative?r(a._callbacks[t]):a._callbacks[t](n.perfNow()),delete a._callbacks[t])},i)),this._callbacks[this._tickCounter]=t,this._tickCounter},n.prototype.cancel=function(t){n.hasNative&&this.options.useNative&&s(t),delete this._callbacks[t]},"object"==typeof a&&"object"==typeof i?i.exports=n:"function"==typeof t&&t.amd?t(function(){return n}):e.AnimationFrame=n}(window)},{}],8:[function(t,e,i){function a(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function n(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+i.humanize(this.diff),!e)return t;var a="color: "+this.color;t=[t[0],a,"color: inherit"].concat(Array.prototype.slice.call(t,1));var n=0,r=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(n++,"%c"===t&&(r=n))}),t.splice(r,0,a),t}function r(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?c.removeItem("debug"):c.debug=t}catch(e){}}function o(){var t;try{t=c.debug}catch(e){}return t}i=e.exports=t("./debug"),i.log=r,i.formatArgs=n,i.save=s,i.load=o,i.useColors=a;var c;c="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:window.localStorage,i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],i.formatters.j=function(t){return JSON.stringify(t)},i.enable(o())},{"./debug":9}],9:[function(t,e,i){function a(){return i.colors[l++%i.colors.length]}function n(t){function e(){}function n(){var t=n,e=+new Date,r=e-(h||e);t.diff=r,t.prev=h,t.curr=e,h=e,null==t.useColors&&(t.useColors=i.useColors()),null==t.color&&t.useColors&&(t.color=a());var s=Array.prototype.slice.call(arguments);s[0]=i.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var o=0;s[0]=s[0].replace(/%([a-z%])/g,function(e,a){if("%%"===e)return e;o++;var n=i.formatters[a];if("function"==typeof n){var r=s[o];e=n.call(t,r),s.splice(o,1),o--}return e}),"function"==typeof i.formatArgs&&(s=i.formatArgs.apply(t,s));var c=n.log||i.log||console.log.bind(console);c.apply(t,s)}e.enabled=!1,n.enabled=!0;var r=i.enabled(t)?n:e;return r.namespace=t,r}function r(t){i.save(t);for(var e=(t||"").split(/[\s,]+/),a=e.length,n=0;a>n;n++)e[n]&&(t=e[n].replace(/\*/g,".*?"),"-"===t[0]?i.skips.push(new RegExp("^"+t.substr(1)+"$")):i.names.push(new RegExp("^"+t+"$")))}function s(){i.enable("")}function o(t){var e,a;for(e=0,a=i.skips.length;a>e;e++)if(i.skips[e].test(t))return!1;for(e=0,a=i.names.length;a>e;e++)if(i.names[e].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}i=e.exports=n,i.coerce=c,i.disable=s,i.enable=r,i.enabled=o,i.humanize=t("ms"),i.names=[],i.skips=[],i.formatters={};var h,l=0},{ms:10}],10:[function(t,e){function i(t){var e=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]),a=(e[2]||"ms").toLowerCase();switch(a){case"years":case"year":case"y":return i*l;case"days":case"day":case"d":return i*h;case"hours":case"hour":case"h":return i*c;case"minutes":case"minute":case"m":return i*o;case"seconds":case"second":case"s":return i*s;case"ms":return i}}}function a(t){return t>=h?Math.round(t/h)+"d":t>=c?Math.round(t/c)+"h":t>=o?Math.round(t/o)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function n(t){return r(t,h,"day")||r(t,c,"hour")||r(t,o,"minute")||r(t,s,"second")||t+" ms"}function r(t,e,i){return e>t?void 0:1.5*e>t?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var s=1e3,o=60*s,c=60*o,h=24*c,l=365.25*h;e.exports=function(t,e){return e=e||{},"string"==typeof t?i(t):e.long?n(t):a(t)}},{}],11:[function(t,e){e.exports={name:"anthParticle",version:"1.1.6",description:"",main:"index.js",scripts:{release:"./node_modules/.bin/gulp release",test:"./node_modules/.bin/gulp karma"},keywords:["cyParticle"],author:"ijse",license:"ISC",devDependencies:{brfs:"^1.2.0",browserify:"^8.0.2",chai:"^1.10.0",gulp:"^3.8.10","gulp-browserify":"^0.5.0","gulp-connect":"^2.2.0","gulp-jshint":"^1.9.0","gulp-karma":"0.0.4","gulp-livereload":"^3.0.2","gulp-mocha":"^2.0.0","gulp-notify":"^2.1.0","gulp-rename":"^1.2.0","gulp-uglify":"^1.0.2","gulp-util":"^3.0.1",karma:"^0.12.28","karma-browserify":"^1.0.0","karma-chai":"^0.1.0","karma-chrome-launcher":"^0.1.7","karma-coverage":"^0.2.7","karma-growl-reporter":"^0.1.1","karma-mocha":"^0.1.10","karma-spec-reporter":"0.0.16",mocha:"^2.1.0",requirejs:"^2.1.15","run-sequence":"^1.0.2"},dependencies:{"animation-frame":"^0.1.7",debug:"^2.1.1",sax:"^0.6.1"}}},{}]},{},[2])(2)});